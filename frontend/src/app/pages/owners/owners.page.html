<div class="pt-20 px-6 pb-6">
  <div class="max-w-5xl mx-auto">
    <div class="flex items-center justify-between mb-4">
      <div>
        <div class="flex items-center gap-2">
          <h1 class="text-2xl font-bold">Service Location Owners</h1>
          <app-help-manual [sectionId]="'owners'"></app-help-manual>
        </div>
        <div class="text-sm text-gray-600">Manage owners (SuperAdmin only)</div>
      </div>
      <div class="flex items-center gap-3">
        <label class="flex items-center gap-2 text-sm text-gray-700">
          <input
            type="checkbox"
            [ngModel]="includeInactive()"
            (ngModelChange)="includeInactive.set($event); loadOwners()"
          />
          Show inactive
        </label>
        <p-button label="Add Owner" icon="pi pi-plus" (onClick)="openCreate()" />
      </div>
    </div>

    <p-table [value]="owners()" [loading]="loading()" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th>Code</th>
          <th>Name</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-owner>
        <tr>
          <td>{{ owner.code }}</td>
          <td>{{ owner.name }}</td>
          <td>
            <span
              class="px-2 py-1 rounded text-xs"
              [class.bg-green-100]="owner.isActive"
              [class.text-green-700]="owner.isActive"
              [class.bg-gray-200]="!owner.isActive"
              [class.text-gray-700]="!owner.isActive"
            >
              {{ owner.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td class="flex gap-2">
            <p-button icon="pi pi-pencil" severity="secondary" [text]="true" (onClick)="openEdit(owner)" />
            <p-button
              icon="pi pi-trash"
              severity="danger"
              [text]="true"
              (onClick)="delete(owner)"
              [disabled]="!owner.isActive"
            />
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<p-dialog
  [(visible)]="showDialogValue"
  [header]="isEdit() ? 'Edit Owner' : 'Add Owner'"
  [modal]="true"
  [style]="{ width: '480px' }"
  (onHide)="showDialog.set(false)"
>
  <div class="flex flex-col gap-3">
    <div>
      <label class="block text-sm font-semibold mb-1">Code</label>
      <input
        pInputText
        class="w-full"
        [ngModel]="form().code"
        (ngModelChange)="onFormChange('code', $event)"
      />
    </div>
    <div>
      <label class="block text-sm font-semibold mb-1">Name</label>
      <input
        pInputText
        class="w-full"
        [ngModel]="form().name"
        (ngModelChange)="onFormChange('name', $event)"
      />
    </div>
    <label class="flex items-center gap-2 text-sm">
      <input
        type="checkbox"
        [ngModel]="form().isActive"
        (ngModelChange)="onFormChange('isActive', $event)"
      />
      Active
    </label>
  </div>
  <ng-template pTemplate="footer">
    <p-button label="Cancel" severity="secondary" (onClick)="showDialog.set(false)" />
    <p-button label="Save" (onClick)="save()" [loading]="loading()" />
  </ng-template>
</p-dialog>

<p-toast />
