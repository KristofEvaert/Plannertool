<div class="container mx-auto px-4 py-6">
  <h2 class="text-2xl font-bold mb-6">Driver Today</h2>

  @if (error()) {
    <p-message severity="error" [text]="error() || ''" class="mb-4" />
  }

  <div class="mb-6">
    <label class="block text-sm font-medium mb-2">Select Driver</label>
    <p-dropdown
      [options]="drivers()"
      [(ngModel)]="selectedDriver"
      optionLabel="name"
      [showClear]="true"
      placeholder="Choose a driver"
      (onChange)="onDriverSelect($event.value)"
      class="w-full md:w-80"
    />
  </div>

  @if (loading() && !driverDay()) {
    <div class="text-center py-8">Loading...</div>
  } @else if (driverDay(); as day) {
    <div class="mb-6">
      <h3 class="text-xl font-semibold mb-2">{{ day.driverName }} - {{ day.date }}</h3>
      <p class="text-gray-600 mb-4">
        Total: {{ day.totalMinutes }} min | {{ day.totalKm.toFixed(1) }} km
      </p>

      @if (!day.routeId || day.stops.length === 0) {
        <div class="text-center py-8 bg-surface border border-surface-border rounded-lg">
          <p class="text-gray-600">No route planned for today</p>
        </div>
      } @else {
        <div class="mb-4">
          <h4 class="font-semibold mb-2">Stops ({{ day.stops.length }})</h4>
          <div class="space-y-2">
            @for (stop of day.stops; track stop.sequence) {
              <div class="p-3 border border-surface-border rounded-lg bg-surface">
                <div class="font-semibold">#{{ stop.sequence }} - {{ stop.serial }}</div>
                @if (stop.plannedStart) {
                  <div class="text-sm text-gray-600">Start: {{ stop.plannedStart }}</div>
                }
              </div>
            }
          </div>
        </div>
        <p-button
          label="Go to Run Mode"
          icon="pi pi-play"
          (onClick)="goToRunMode()"
        />
      }
    </div>
  }
</div>


